import type { Request } from 'express';
import { PrismaService } from '../prisma/prisma.service';
import { Prisma } from '@prisma/client';
import { CreateSupplierDto } from './dto/create-supplier.dto';
import { CreateSupplierInvoiceDto } from './dto/create-supplier-invoice.dto';
import type { StorageProvider } from '../storage/storage.provider';
import { UploadSupplierDocumentDto } from './dto/upload-supplier-document.dto';
import { CreateSupplierBankAccountDto } from './dto/create-supplier-bank-account.dto';
import { UpdateSupplierBankAccountDto } from './dto/update-supplier-bank-account.dto';
export declare class ApService {
    private readonly prisma;
    private readonly storage;
    constructor(prisma: PrismaService, storage: StorageProvider);
    private round2;
    private resolveSupplierAuditEntity;
    private normalizeHeaderKey;
    private parseBooleanStrict;
    private parseCsvRows;
    private mapWithholdingProfileStrict;
    private assertActiveSupplier;
    private createSupplierChangeLog;
    getSupplierImportCsvTemplate(req: Request): Promise<{
        fileName: string;
        body: string;
    }>;
    previewSupplierImport(req: Request, file?: any): Promise<{
        fileName: string;
        totalRows: number;
        errorCount: number;
        errors: {
            rowNumber: number;
            field?: string;
            message: string;
        }[];
        rows: {
            rowNumber: number;
            name: string;
            taxNumber: string | undefined;
            registrationNumber: string | undefined;
            vatRegistered: boolean | undefined;
            defaultPaymentTerms: string | undefined;
            defaultCurrency: string | undefined;
            withholdingProfile: any;
            email: string | undefined;
            phone: string | undefined;
            address: string | undefined;
            isDuplicate: boolean;
            isValid: boolean;
        }[];
    }>;
    commitSupplierImport(req: Request, rows: any[]): Promise<{
        created: number;
        skippedDuplicates: number;
        skippedInvalid: number;
        received: number;
    }>;
    listSupplierDocuments(req: Request, supplierId: string): Promise<{
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
        supplierId: string;
        docType: string;
        filename: string;
        mimeType: string;
        storageKey: string;
        fileSize: number | null;
        notes: string | null;
        createdById: string;
    }[]>;
    uploadSupplierDocument(req: Request, supplierId: string, dto: UploadSupplierDocumentDto, file?: any): Promise<{
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
        supplierId: string;
        docType: string;
        filename: string;
        mimeType: string;
        storageKey: string;
        fileSize: number | null;
        notes: string | null;
        createdById: string;
    }>;
    deactivateSupplierDocument(req: Request, supplierId: string, docId: string): Promise<{
        ok: boolean;
    }>;
    downloadSupplierDocument(req: Request, supplierId: string, docId: string): Promise<{
        fileName: string;
        mimeType: string;
        size: number;
        body: Buffer<ArrayBufferLike>;
    }>;
    listSupplierBankAccounts(req: Request, supplierId: string): Promise<{
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
        updatedAt: Date;
        supplierId: string;
        notes: string | null;
        createdById: string;
        bankName: string;
        branchName: string | null;
        accountName: string;
        accountNumber: string;
        currency: string | null;
        swiftCode: string | null;
        isPrimary: boolean;
        updatedById: string | null;
    }[]>;
    createSupplierBankAccount(req: Request, supplierId: string, dto: CreateSupplierBankAccountDto): Promise<{
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
        updatedAt: Date;
        supplierId: string;
        notes: string | null;
        createdById: string;
        bankName: string;
        branchName: string | null;
        accountName: string;
        accountNumber: string;
        currency: string | null;
        swiftCode: string | null;
        isPrimary: boolean;
        updatedById: string | null;
    }>;
    updateSupplierBankAccount(req: Request, supplierId: string, bankId: string, dto: UpdateSupplierBankAccountDto): Promise<{
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
        updatedAt: Date;
        supplierId: string;
        notes: string | null;
        createdById: string;
        bankName: string;
        branchName: string | null;
        accountName: string;
        accountNumber: string;
        currency: string | null;
        swiftCode: string | null;
        isPrimary: boolean;
        updatedById: string | null;
    }>;
    deactivateSupplierBankAccount(req: Request, supplierId: string, bankId: string): Promise<{
        ok: boolean;
    }>;
    setPrimarySupplierBankAccount(req: Request, supplierId: string, bankId: string): Promise<{
        ok: boolean;
    }>;
    listSupplierChangeHistory(req: Request, supplierId: string): Promise<{
        id: string;
        tenantId: string;
        createdAt: Date;
        supplierId: string;
        changeType: string;
        field: string | null;
        oldValue: string | null;
        newValue: string | null;
        refId: string | null;
        actorUserId: string;
    }[]>;
    createSupplier(req: Request, dto: CreateSupplierDto): Promise<{
        name: string;
        taxNumber: string | null;
        registrationNumber: string | null;
        vatRegistered: boolean;
        defaultPaymentTerms: string | null;
        defaultCurrency: string;
        withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
        email: string | null;
        phone: string | null;
        address: string | null;
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
    }>;
    listSuppliers(req: Request): Promise<{
        name: string;
        taxNumber: string | null;
        registrationNumber: string | null;
        vatRegistered: boolean;
        defaultPaymentTerms: string | null;
        defaultCurrency: string;
        withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
        email: string | null;
        phone: string | null;
        address: string | null;
        id: string;
        tenantId: string;
        isActive: boolean;
        createdAt: Date;
    }[]>;
    listEligibleAccounts(req: Request): Promise<{
        name: string;
        id: string;
        code: string;
        type: import("@prisma/client").$Enums.AccountType;
    }[]>;
    createInvoice(req: Request, dto: CreateSupplierInvoiceDto): Promise<any>;
    submitInvoice(req: Request, id: string): Promise<{
        supplier: {
            name: string;
            taxNumber: string | null;
            registrationNumber: string | null;
            vatRegistered: boolean;
            defaultPaymentTerms: string | null;
            defaultCurrency: string;
            withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
            email: string | null;
            phone: string | null;
            address: string | null;
            id: string;
            tenantId: string;
            isActive: boolean;
            createdAt: Date;
        };
        lines: {
            id: string;
            supplierInvoiceId: string;
            accountId: string;
            description: string;
            amount: Prisma.Decimal;
        }[];
    } & {
        id: string;
        tenantId: string;
        createdAt: Date;
        status: import("@prisma/client").$Enums.SupplierInvoiceStatus;
        supplierId: string;
        createdById: string;
        invoiceNumber: string;
        invoiceDate: Date;
        dueDate: Date;
        totalAmount: Prisma.Decimal;
        approvedById: string | null;
        postedById: string | null;
        approvedAt: Date | null;
        postedAt: Date | null;
    }>;
    approveInvoice(req: Request, id: string): Promise<{
        supplier: {
            name: string;
            taxNumber: string | null;
            registrationNumber: string | null;
            vatRegistered: boolean;
            defaultPaymentTerms: string | null;
            defaultCurrency: string;
            withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
            email: string | null;
            phone: string | null;
            address: string | null;
            id: string;
            tenantId: string;
            isActive: boolean;
            createdAt: Date;
        };
        lines: {
            id: string;
            supplierInvoiceId: string;
            accountId: string;
            description: string;
            amount: Prisma.Decimal;
        }[];
    } & {
        id: string;
        tenantId: string;
        createdAt: Date;
        status: import("@prisma/client").$Enums.SupplierInvoiceStatus;
        supplierId: string;
        createdById: string;
        invoiceNumber: string;
        invoiceDate: Date;
        dueDate: Date;
        totalAmount: Prisma.Decimal;
        approvedById: string | null;
        postedById: string | null;
        approvedAt: Date | null;
        postedAt: Date | null;
    }>;
    postInvoice(req: Request, id: string, opts?: {
        apControlAccountCode?: string;
    }): Promise<{
        invoice: {
            supplier: {
                name: string;
                taxNumber: string | null;
                registrationNumber: string | null;
                vatRegistered: boolean;
                defaultPaymentTerms: string | null;
                defaultCurrency: string;
                withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
                email: string | null;
                phone: string | null;
                address: string | null;
                id: string;
                tenantId: string;
                isActive: boolean;
                createdAt: Date;
            };
            lines: {
                id: string;
                supplierInvoiceId: string;
                accountId: string;
                description: string;
                amount: Prisma.Decimal;
            }[];
        } & {
            id: string;
            tenantId: string;
            createdAt: Date;
            status: import("@prisma/client").$Enums.SupplierInvoiceStatus;
            supplierId: string;
            createdById: string;
            invoiceNumber: string;
            invoiceDate: Date;
            dueDate: Date;
            totalAmount: Prisma.Decimal;
            approvedById: string | null;
            postedById: string | null;
            approvedAt: Date | null;
            postedAt: Date | null;
        };
        glJournal: {
            lines: {
                id: string;
                accountId: string;
                description: string | null;
                debit: Prisma.Decimal;
                credit: Prisma.Decimal;
                lineNumber: number | null;
                departmentId: string | null;
                legalEntityId: string | null;
                fundId: string | null;
                projectId: string | null;
                journalEntryId: string;
            }[];
        } & {
            id: string;
            tenantId: string;
            createdAt: Date;
            status: import("@prisma/client").$Enums.JournalStatus;
            createdById: string;
            sourceType: string | null;
            sourceId: string | null;
            approvedById: string | null;
            postedById: string | null;
            approvedAt: Date | null;
            postedAt: Date | null;
            description: string | null;
            reference: string | null;
            journalDate: Date;
            journalNumber: number | null;
            journalType: import("@prisma/client").$Enums.JournalType;
            periodId: string | null;
            reversalOfId: string | null;
            reviewedById: string | null;
            reviewedAt: Date | null;
            submittedAt: Date | null;
            submittedById: string | null;
            rejectedAt: Date | null;
            rejectedById: string | null;
            rejectionReason: string | null;
            returnReason: string | null;
            returnedByPosterAt: Date | null;
            returnedByPosterId: string | null;
            reversalInitiatedAt: Date | null;
            reversalInitiatedById: string | null;
            reversalReason: string | null;
            reversalPreparedById: string | null;
            correctsJournalId: string | null;
            riskScore: number;
            riskFlags: Prisma.JsonValue;
            riskComputedAt: Date | null;
            budgetCheckedAt: Date | null;
            budgetFlags: Prisma.JsonValue | null;
            budgetOverrideJustification: string | null;
            budgetStatus: import("@prisma/client").$Enums.JournalBudgetStatus;
        };
    }>;
    private validateTaxLines;
    private assertTaxIntegrityBeforeSubmit;
    listInvoices(req: Request): Promise<({
        supplier: {
            name: string;
            taxNumber: string | null;
            registrationNumber: string | null;
            vatRegistered: boolean;
            defaultPaymentTerms: string | null;
            defaultCurrency: string;
            withholdingProfile: import("@prisma/client").$Enums.WithholdingProfile;
            email: string | null;
            phone: string | null;
            address: string | null;
            id: string;
            tenantId: string;
            isActive: boolean;
            createdAt: Date;
        };
        lines: {
            id: string;
            supplierInvoiceId: string;
            accountId: string;
            description: string;
            amount: Prisma.Decimal;
        }[];
    } & {
        id: string;
        tenantId: string;
        createdAt: Date;
        status: import("@prisma/client").$Enums.SupplierInvoiceStatus;
        supplierId: string;
        createdById: string;
        invoiceNumber: string;
        invoiceDate: Date;
        dueDate: Date;
        totalAmount: Prisma.Decimal;
        approvedById: string | null;
        postedById: string | null;
        approvedAt: Date | null;
        postedAt: Date | null;
    })[]>;
    private assertInvoiceLines;
}
