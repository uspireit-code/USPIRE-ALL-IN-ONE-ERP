generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model TenantSequenceCounter {
  id        String   @id @default(uuid())
  tenantId  String
  name      String
  value     Int      @default(0)
  updatedAt DateTime @default(now()) @updatedAt
  tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, name])
  @@index([tenantId])
}

model FixedAssetCategory {
  id                      String             @id @default(uuid())
  tenantId                String
  code                    String
  name                    String
  defaultMethod           DepreciationMethod @default(STRAIGHT_LINE)
  defaultUsefulLifeMonths Int
  defaultResidualRate     Decimal?           @db.Decimal(7, 4)
  assetAccountId          String
  accumDepAccountId       String
  depExpenseAccountId     String
  createdAt               DateTime           @default(now())
  assets                  FixedAsset[]
  accumDepAccount         Account            @relation("FixedAssetCategoryAccumDepAccount", fields: [accumDepAccountId], references: [id])
  assetAccount            Account            @relation("FixedAssetCategoryAssetAccount", fields: [assetAccountId], references: [id])
  depExpenseAccount       Account            @relation("FixedAssetCategoryDepExpenseAccount", fields: [depExpenseAccountId], references: [id])
  tenant                  Tenant             @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, code])
  @@index([tenantId])
}

model FixedAsset {
  id                      String                       @id @default(uuid())
  tenantId                String
  categoryId              String
  name                    String
  description             String?
  acquisitionDate         DateTime
  capitalizationDate      DateTime?
  cost                    Decimal                      @db.Decimal(18, 2)
  residualValue           Decimal                      @db.Decimal(18, 2)
  usefulLifeMonths        Int
  method                  DepreciationMethod           @default(STRAIGHT_LINE)
  status                  FixedAssetStatus             @default(DRAFT)
  assetAccountId          String?
  accumDepAccountId       String?
  depExpenseAccountId     String?
  vendorId                String?
  apInvoiceId             String?
  capitalizationJournalId String?
  disposalJournalId       String?
  createdAt               DateTime                     @default(now())
  createdById             String
  accumDepAccount         Account?                     @relation("FixedAssetAccumDepAccount", fields: [accumDepAccountId], references: [id], onDelete: Restrict)
  apInvoice               SupplierInvoice?             @relation(fields: [apInvoiceId], references: [id], onDelete: Restrict)
  assetAccount            Account?                     @relation("FixedAssetAssetAccount", fields: [assetAccountId], references: [id], onDelete: Restrict)
  capitalizationJournal   JournalEntry?                @relation("FixedAssetCapitalizationJournal", fields: [capitalizationJournalId], references: [id], onDelete: Restrict)
  category                FixedAssetCategory           @relation(fields: [categoryId], references: [id])
  createdBy               User                         @relation("FixedAssetCreatedBy", fields: [createdById], references: [id])
  depExpenseAccount       Account?                     @relation("FixedAssetDepExpenseAccount", fields: [depExpenseAccountId], references: [id], onDelete: Restrict)
  disposalJournal         JournalEntry?                @relation("FixedAssetDisposalJournal", fields: [disposalJournalId], references: [id], onDelete: Restrict)
  tenant                  Tenant                       @relation(fields: [tenantId], references: [id])
  vendor                  Supplier?                    @relation(fields: [vendorId], references: [id], onDelete: Restrict)
  depreciationLines       FixedAssetDepreciationLine[]

  @@index([tenantId])
  @@index([tenantId, status])
  @@index([createdById])
  @@index([categoryId])
}

model FixedAssetDepreciationRun {
  id             String                          @id @default(uuid())
  tenantId       String
  periodId       String
  runDate        DateTime                        @default(now())
  postedById     String
  status         FixedAssetDepreciationRunStatus @default(POSTED)
  journalEntryId String?
  lines          FixedAssetDepreciationLine[]
  journalEntry   JournalEntry?                   @relation("FixedAssetDepreciationRunJournal", fields: [journalEntryId], references: [id], onDelete: Restrict)
  period         AccountingPeriod                @relation(fields: [periodId], references: [id])
  postedBy       User                            @relation("FixedAssetDepreciationRunPostedBy", fields: [postedById], references: [id])
  tenant         Tenant                          @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, periodId])
  @@index([tenantId])
  @@index([periodId])
}

model FixedAssetDepreciationLine {
  id        String                    @id @default(uuid())
  tenantId  String
  runId     String
  assetId   String
  amount    Decimal                   @db.Decimal(18, 2)
  createdAt DateTime                  @default(now())
  asset     FixedAsset                @relation(fields: [assetId], references: [id])
  run       FixedAssetDepreciationRun @relation(fields: [runId], references: [id], onDelete: Cascade)
  tenant    Tenant                    @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, runId, assetId])
  @@index([tenantId])
  @@index([runId])
  @@index([assetId])
}

model InvoiceCategory {
  id                 String            @id @default(uuid())
  tenantId           String
  name               String
  code               String
  isActive           Boolean           @default(true)
  revenueAccountId   String
  requiresProject    Boolean           @default(false)
  requiresFund       Boolean           @default(false)
  requiresDepartment Boolean           @default(false)
  createdAt          DateTime          @default(now())
  updatedAt          DateTime          @updatedAt
  isSystemDefault    Boolean           @default(false)
  customerInvoices   CustomerInvoice[]
  revenueAccount     Account           @relation("InvoiceCategoryRevenueAccount", fields: [revenueAccountId], references: [id])
  tenant             Tenant            @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, code])
  @@index([tenantId])
}

model ArReminderRule {
  id              String                @id @default(uuid())
  tenantId        String
  name            String
  triggerType     ArReminderTriggerType
  daysOffset      Int
  active          Boolean               @default(true)
  escalationLevel ArReminderLevel
  createdById     String
  createdAt       DateTime              @default(now())
  logs            ArReminderLog[]
  createdBy       User                  @relation("ArReminderRuleCreatedBy", fields: [createdById], references: [id])
  tenant          Tenant                @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, name])
  @@index([tenantId])
  @@index([tenantId, active])
  @@index([tenantId, triggerType])
  @@index([createdById])
}

model ArReminderTemplate {
  id              String          @id @default(uuid())
  tenantId        String
  level           ArReminderLevel
  subject         String
  body            String
  active          Boolean         @default(true)
  lastUpdatedById String
  lastUpdatedAt   DateTime        @default(now()) @updatedAt
  lastUpdatedBy   User            @relation("ArReminderTemplateLastUpdatedBy", fields: [lastUpdatedById], references: [id])
  tenant          Tenant          @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, level])
  @@index([tenantId])
  @@index([tenantId, active])
  @@index([lastUpdatedById])
}

model ArReminderLog {
  id             String                @id @default(uuid())
  tenantId       String
  customerId     String
  invoiceId      String
  reminderRuleId String?
  reminderLevel  ArReminderLevel
  triggerMode    ArReminderTriggerMode
  sentById       String
  sentAt         DateTime              @default(now())
  customer       Customer              @relation(fields: [customerId], references: [id])
  invoice        CustomerInvoice       @relation(fields: [invoiceId], references: [id])
  reminderRule   ArReminderRule?       @relation(fields: [reminderRuleId], references: [id])
  sentBy         User                  @relation("ArReminderLogSentBy", fields: [sentById], references: [id])
  tenant         Tenant                @relation(fields: [tenantId], references: [id])

  @@index([tenantId])
  @@index([tenantId, sentAt])
  @@index([tenantId, customerId])
  @@index([tenantId, invoiceId])
  @@index([sentById])
}

model TenantTaxConfig {
  tenantId           String   @id
  outputVatAccountId String?
  inputVatAccountId  String?
  inputVatAccount    Account? @relation("TenantTaxConfigInputVatAccount", fields: [inputVatAccountId], references: [id], onDelete: Restrict)
  outputVatAccount   Account? @relation("TenantTaxConfigOutputVatAccount", fields: [outputVatAccountId], references: [id], onDelete: Restrict)
  tenant             Tenant   @relation(fields: [tenantId], references: [id])

  @@index([outputVatAccountId])
  @@index([inputVatAccountId])
}

model TaxRate {
  id                   String                @id @default(uuid())
  tenantId             String
  name                 String
  rate                 Decimal               @db.Decimal(5, 2)
  type                 TaxRateType
  glAccountId          String?
  isActive             Boolean               @default(true)
  createdAt            DateTime              @default(now())
  code                 String
  customerInvoiceLines CustomerInvoiceLine[]
  taxLines             InvoiceTaxLine[]
  glAccount            Account?              @relation(fields: [glAccountId], references: [id], onDelete: Restrict)
  tenant               Tenant                @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, name])
  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([glAccountId])
}

model BankStatement {
  id             String              @id @default(uuid())
  tenantId       String
  bankAccountId  String
  statementDate  DateTime
  openingBalance Decimal             @db.Decimal(18, 2)
  closingBalance Decimal             @db.Decimal(18, 2)
  createdAt      DateTime            @default(now())
  bankAccount    BankAccount         @relation(fields: [bankAccountId], references: [id])
  tenant         Tenant              @relation(fields: [tenantId], references: [id])
  lines          BankStatementLine[]

  @@unique([tenantId, bankAccountId, statementDate])
  @@index([tenantId])
  @@index([bankAccountId])
}

model BankStatementLine {
  id              String              @id @default(uuid())
  bankStatementId String
  transactionDate DateTime
  description     String
  amount          Decimal             @db.Decimal(18, 2)
  reference       String?
  isReconciled    Boolean             @default(false)
  reconciledAt    DateTime?
  reconciledBy    String?
  reconciliation  BankReconciliation?
  bankStatement   BankStatement       @relation(fields: [bankStatementId], references: [id], onDelete: Cascade)

  @@index([bankStatementId])
  @@index([transactionDate])
  @@index([isReconciled])
}

model BankReconciliation {
  id              String            @id @default(uuid())
  tenantId        String
  bankAccountId   String
  paymentId       String?           @unique
  statementLineId String            @unique
  reconciledAt    DateTime
  reconciledBy    String
  bankAccount     BankAccount       @relation(fields: [bankAccountId], references: [id])
  payment         Payment?          @relation(fields: [paymentId], references: [id], onDelete: Restrict)
  statementLine   BankStatementLine @relation(fields: [statementLineId], references: [id])
  tenant          Tenant            @relation(fields: [tenantId], references: [id])

  @@index([tenantId])
  @@index([bankAccountId])
}

model InvoiceTaxLine {
  id            String               @id @default(uuid())
  tenantId      String
  sourceType    InvoiceTaxSourceType
  sourceId      String
  taxRateId     String
  taxableAmount Decimal              @db.Decimal(18, 2)
  taxAmount     Decimal              @db.Decimal(18, 2)
  createdAt     DateTime             @default(now())
  taxRate       TaxRate              @relation(fields: [taxRateId], references: [id])
  tenant        Tenant               @relation(fields: [tenantId], references: [id])

  @@index([tenantId])
  @@index([sourceType, sourceId])
  @@index([taxRateId])
}

model BankAccount {
  id              String               @id @default(uuid())
  tenantId        String
  name            String
  bankName        String
  accountNumber   String
  currency        String
  glAccountId     String
  isActive        Boolean              @default(true)
  createdAt       DateTime             @default(now())
  glAccount       Account              @relation(fields: [glAccountId], references: [id])
  tenant          Tenant               @relation(fields: [tenantId], references: [id])
  reconciliations BankReconciliation[]
  statements      BankStatement[]
  customerRefunds CustomerRefund[]
  payments        Payment[]

  @@unique([tenantId, name])
  @@index([tenantId])
  @@index([glAccountId])
}

model Payment {
  id              String              @id @default(uuid())
  tenantId        String
  type            PaymentType
  bankAccountId   String
  amount          Decimal             @db.Decimal(18, 2)
  paymentDate     DateTime
  reference       String?
  status          PaymentStatus       @default(DRAFT)
  createdById     String
  approvedById    String?
  postedById      String?
  createdAt       DateTime            @default(now())
  approvedAt      DateTime?
  postedAt        DateTime?
  reconciliations BankReconciliation?
  approvedBy      User?               @relation("PaymentApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  bankAccount     BankAccount         @relation(fields: [bankAccountId], references: [id])
  createdBy       User                @relation("PaymentCreatedBy", fields: [createdById], references: [id])
  postedBy        User?               @relation("PaymentPostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  tenant          Tenant              @relation(fields: [tenantId], references: [id])
  allocations     PaymentAllocation[]

  @@index([tenantId])
  @@index([tenantId, status])
  @@index([bankAccountId])
}

model PaymentAllocation {
  id         String                      @id @default(uuid())
  paymentId  String
  sourceType PaymentAllocationSourceType
  sourceId   String
  amount     Decimal                     @db.Decimal(18, 2)
  payment    Payment                     @relation(fields: [paymentId], references: [id], onDelete: Cascade)

  @@index([paymentId])
  @@index([sourceType, sourceId])
}

model Customer {
  id             String               @id @default(uuid())
  tenantId       String
  name           String
  taxNumber      String?
  createdAt      DateTime             @default(now())
  billingAddress String?
  customerCode   String?
  email          String?
  phone          String?
  status         CustomerStatus       @default(ACTIVE)
  updatedAt      DateTime             @default(now()) @updatedAt
  contactPerson  String?
  reminderLogs   ArReminderLog[]
  tenant         Tenant               @relation(fields: [tenantId], references: [id])
  creditNotes    CustomerCreditNote[]
  invoices       CustomerInvoice[]
  receipts       CustomerReceipt[]
  refunds        CustomerRefund[]

  @@unique([tenantId, customerCode])
  @@index([tenantId])
  @@index([tenantId, status])
  @@index([tenantId, name])
}

model CustomerInvoice {
  id                             String                @id @default(uuid())
  tenantId                       String
  customerId                     String
  invoiceNumber                  String
  invoiceDate                    DateTime
  dueDate                        DateTime
  totalAmount                    Decimal               @db.Decimal(18, 2)
  status                         CustomerInvoiceStatus @default(DRAFT)
  createdById                    String
  postedById                     String?
  createdAt                      DateTime              @default(now())
  postedAt                       DateTime?
  currency                       String
  reference                      String?
  subtotal                       Decimal               @db.Decimal(18, 2)
  taxAmount                      Decimal               @db.Decimal(18, 2)
  customerBillingAddressSnapshot String?
  customerEmailSnapshot          String?
  customerNameSnapshot           String                @default("")
  exchangeRate                   Decimal               @default(1.0) @db.Decimal(18, 6)
  invoiceNote                    String?
  invoiceCategoryId              String?
  fundId                         String?
  departmentId                   String?
  isTaxable                      Boolean               @default(false)
  invoiceType                    InvoiceType?
  projectId                      String?
  reminderLogs                   ArReminderLog[]
  creditNotes                    CustomerCreditNote[]  @relation("CustomerCreditNoteInvoice")
  createdBy                      User                  @relation("CustomerInvoiceCreatedBy", fields: [createdById], references: [id])
  customer                       Customer              @relation(fields: [customerId], references: [id])
  department                     Department?           @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  fund                           Fund?                 @relation(fields: [fundId], references: [id], onDelete: Restrict)
  invoiceCategory                InvoiceCategory?      @relation(fields: [invoiceCategoryId], references: [id], onDelete: Restrict)
  postedBy                       User?                 @relation("CustomerInvoicePostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  project                        Project?              @relation("CustomerInvoiceProject", fields: [projectId], references: [id], onDelete: Restrict)
  tenant                         Tenant                @relation(fields: [tenantId], references: [id])
  lines                          CustomerInvoiceLine[]
  receiptLines                   CustomerReceiptLine[]

  @@unique([tenantId, customerId, invoiceNumber])
  @@index([tenantId])
  @@index([tenantId, status])
  @@index([invoiceCategoryId])
  @@index([projectId])
  @@index([fundId])
  @@index([departmentId])
}

model CustomerCreditNote {
  id               String                   @id @default(uuid())
  tenantId         String
  creditNoteNumber String
  creditNoteDate   DateTime
  customerId       String
  invoiceId        String?
  currency         String
  exchangeRate     Decimal                  @default(1.0) @db.Decimal(18, 6)
  subtotal         Decimal                  @db.Decimal(18, 2)
  totalAmount      Decimal                  @db.Decimal(18, 2)
  status           DocumentStatus           @default(DRAFT)
  createdById      String
  approvedById     String?
  postedById       String?
  createdAt        DateTime                 @default(now())
  updatedAt        DateTime                 @updatedAt
  memo             String?
  approvedAt       DateTime?
  postedAt         DateTime?
  voidedById       String?
  voidedAt         DateTime?
  voidReason       String?
  postedJournalId  String?
  taxAmount        Decimal?                 @db.Decimal(15, 2)
  isTaxable        Boolean                  @default(false)
  approvedBy       User?                    @relation("CustomerCreditNoteApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  createdBy        User                     @relation("CustomerCreditNoteCreatedBy", fields: [createdById], references: [id])
  customer         Customer                 @relation(fields: [customerId], references: [id])
  invoice          CustomerInvoice?         @relation("CustomerCreditNoteInvoice", fields: [invoiceId], references: [id], onDelete: Restrict)
  postedBy         User?                    @relation("CustomerCreditNotePostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  postedJournal    JournalEntry?            @relation("CustomerCreditNotePostedJournal", fields: [postedJournalId], references: [id], onDelete: Restrict)
  tenant           Tenant                   @relation(fields: [tenantId], references: [id])
  voidedBy         User?                    @relation("CustomerCreditNoteVoidedBy", fields: [voidedById], references: [id], onDelete: Restrict)
  lines            CustomerCreditNoteLine[]
  refunds          CustomerRefund[]

  @@unique([tenantId, creditNoteNumber])
  @@unique([tenantId, postedJournalId])
  @@index([tenantId, creditNoteNumber])
  @@index([tenantId, customerId])
  @@index([tenantId, invoiceId])
  @@index([tenantId, status])
}

model CustomerCreditNoteLine {
  id               String             @id @default(uuid())
  creditNoteId     String
  description      String
  quantity         Decimal            @db.Decimal(18, 2)
  unitPrice        Decimal            @db.Decimal(18, 2)
  lineAmount       Decimal            @db.Decimal(18, 2)
  revenueAccountId String
  departmentId     String?
  projectId        String?
  fundId           String?
  creditNote       CustomerCreditNote @relation(fields: [creditNoteId], references: [id], onDelete: Cascade)
  department       Department?        @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  fund             Fund?              @relation(fields: [fundId], references: [id], onDelete: Restrict)
  project          Project?           @relation(fields: [projectId], references: [id], onDelete: Restrict)
  revenueAccount   Account            @relation(fields: [revenueAccountId], references: [id])

  @@index([creditNoteId])
}

model CustomerRefund {
  /// Rules:
  /// - At least one of receiptId or creditNoteId must be provided.
  /// - Refund cannot exceed available unapplied/credit balance (enforced later in Step 4.2).
  id              String              @id @default(uuid())
  tenantId        String
  refundNumber    String
  refundDate      DateTime
  customerId      String
  receiptId       String?
  creditNoteId    String?
  currency        String
  exchangeRate    Decimal             @default(1.0) @db.Decimal(18, 6)
  amount          Decimal             @db.Decimal(18, 2)
  status          DocumentStatus      @default(DRAFT)
  createdById     String
  approvedById    String?
  postedById      String?
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  paymentMethod   RefundPaymentMethod
  bankAccountId   String?
  voidedById      String?
  approvedAt      DateTime?
  postedAt        DateTime?
  voidedAt        DateTime?
  voidReason      String?
  postedJournalId String?
  approvedBy      User?               @relation("CustomerRefundApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  bankAccount     BankAccount?        @relation(fields: [bankAccountId], references: [id], onDelete: Restrict)
  createdBy       User                @relation("CustomerRefundCreatedBy", fields: [createdById], references: [id])
  creditNote      CustomerCreditNote? @relation(fields: [creditNoteId], references: [id], onDelete: Restrict)
  customer        Customer            @relation(fields: [customerId], references: [id])
  postedBy        User?               @relation("CustomerRefundPostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  postedJournal   JournalEntry?       @relation("CustomerRefundPostedJournal", fields: [postedJournalId], references: [id], onDelete: Restrict)
  receipt         CustomerReceipt?    @relation(fields: [receiptId], references: [id], onDelete: Restrict)
  tenant          Tenant              @relation(fields: [tenantId], references: [id])
  voidedBy        User?               @relation("CustomerRefundVoidedBy", fields: [voidedById], references: [id], onDelete: Restrict)

  @@unique([tenantId, refundNumber])
  @@unique([tenantId, postedJournalId])
  @@index([tenantId, refundNumber])
  @@index([tenantId, customerId])
  @@index([tenantId, creditNoteId])
}

model AccountingPeriodChecklistItem {
  id            String           @id @default(uuid())
  tenantId      String
  periodId      String
  code          String
  label         String
  completed     Boolean          @default(false)
  completedById String?
  completedAt   DateTime?
  createdAt     DateTime         @default(now())
  completedBy   User?            @relation("AccountingPeriodChecklistItemCompletedBy", fields: [completedById], references: [id], onDelete: Restrict)
  period        AccountingPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)
  tenant        Tenant           @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, periodId, code])
  @@index([tenantId])
  @@index([periodId])
  @@index([completedById])
}

model AccountingPeriodChecklist {
  id            String           @id @default(uuid())
  tenantId      String
  periodId      String
  checklistCode String
  checklistName String
  required      Boolean          @default(true)
  completed     Boolean          @default(false)
  completedById String?
  completedAt   DateTime?
  createdAt     DateTime         @default(now())
  completedBy   User?            @relation("AccountingPeriodChecklistCompletedBy", fields: [completedById], references: [id], onDelete: Restrict)
  period        AccountingPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)
  tenant        Tenant           @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, periodId, checklistCode])
  @@index([tenantId])
  @@index([periodId])
  @@index([completedById])
}

model AccountingPeriodCloseLog {
  id        String           @id @default(uuid())
  tenantId  String
  periodId  String
  userId    String
  action    String
  outcome   String
  message   String?
  itemId    String?
  createdAt DateTime         @default(now())
  period    AccountingPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)
  tenant    Tenant           @relation(fields: [tenantId], references: [id])
  user      User             @relation(fields: [userId], references: [id])

  @@index([tenantId])
  @@index([periodId])
  @@index([userId])
}

model AuditEvent {
  id                String          @id @default(uuid())
  tenantId          String
  eventType         AuditEventType
  entityType        AuditEntityType
  entityId          String
  action            String
  outcome           AuditOutcome
  reason            String?
  userId            String
  permissionUsed    String?
  createdAt         DateTime        @default(now())
  forecastId        String?
  forecastVersionId String?
  tenant            Tenant          @relation(fields: [tenantId], references: [id])
  user              User            @relation(fields: [userId], references: [id])

  @@index([tenantId])
  @@index([tenantId, createdAt])
  @@index([tenantId, entityType, entityId])
  @@index([tenantId, userId])
  @@index([tenantId, forecastId])
  @@index([tenantId, forecastVersionId])
  @@index([tenantId, eventType, createdAt])
  @@index([entityType, entityId])
}

model Forecast {
  id          String            @id @default(uuid())
  tenantId    String
  fiscalYear  Int
  name        String
  status      ForecastStatus    @default(DRAFT)
  createdById String
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  createdBy   User              @relation("ForecastCreatedBy", fields: [createdById], references: [id])
  tenant      Tenant            @relation(fields: [tenantId], references: [id])
  versions    ForecastVersion[]

  @@unique([tenantId, fiscalYear])
  @@index([tenantId])
  @@index([tenantId, fiscalYear])
  @@index([createdById])
}

model ForecastVersion {
  id            String         @id @default(uuid())
  forecastId    String
  versionNumber Int
  status        ForecastStatus @default(DRAFT)
  createdById   String
  createdAt     DateTime       @default(now())
  lines         ForecastLine[]
  createdBy     User           @relation("ForecastVersionCreatedBy", fields: [createdById], references: [id])
  forecast      Forecast       @relation(fields: [forecastId], references: [id], onDelete: Cascade)

  @@unique([forecastId, versionNumber])
  @@index([forecastId])
  @@index([createdById])
  @@index([forecastId, status])
}

model ForecastLine {
  id                String          @id @default(uuid())
  forecastVersionId String
  accountId         String
  month             Int
  amount            Decimal         @db.Decimal(18, 2)
  account           Account         @relation(fields: [accountId], references: [id])
  version           ForecastVersion @relation(fields: [forecastVersionId], references: [id], onDelete: Cascade)

  @@unique([forecastVersionId, accountId, month])
  @@index([forecastVersionId])
  @@index([accountId])
  @@index([forecastVersionId, month])
  @@index([forecastVersionId, accountId, month])
}

model AuditEvidence {
  id           String          @id @default(uuid())
  tenantId     String
  entityType   AuditEntityType
  entityId     String
  fileName     String
  mimeType     String
  size         Int
  storageKey   String
  sha256Hash   String
  uploadedById String
  createdAt    DateTime        @default(now())
  tenant       Tenant          @relation(fields: [tenantId], references: [id])
  uploadedBy   User            @relation("AuditEvidenceUploadedBy", fields: [uploadedById], references: [id])

  @@unique([tenantId, storageKey])
  @@index([tenantId])
  @@index([tenantId, entityType, entityId])
  @@index([uploadedById])
  @@index([tenantId, createdAt])
}

model ReviewPack {
  id             String           @id @default(uuid())
  tenantId       String
  periodId       String
  generatedById  String
  storageKey     String
  zipSize        Int
  zipSha256Hash  String
  manifest       Json
  manifestSha256 String
  createdAt      DateTime         @default(now())
  generatedBy    User             @relation("ReviewPackGeneratedBy", fields: [generatedById], references: [id])
  period         AccountingPeriod @relation(fields: [periodId], references: [id])
  tenant         Tenant           @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, storageKey])
  @@index([tenantId])
  @@index([tenantId, periodId])
  @@index([tenantId, createdAt])
}

model CustomerInvoiceLine {
  id                String          @id @default(uuid())
  customerInvoiceId String
  accountId         String
  description       String
  lineTotal         Decimal         @db.Decimal(18, 2)
  quantity          Decimal         @db.Decimal(18, 6)
  unitPrice         Decimal         @db.Decimal(18, 6)
  discountAmount    Decimal?        @db.Decimal(18, 2)
  discountPercent   Decimal?        @db.Decimal(18, 6)
  discountTotal     Decimal         @default(0) @db.Decimal(18, 2)
  departmentId      String?
  fundId            String?
  projectId         String?
  taxRateId         String?
  account           Account         @relation(fields: [accountId], references: [id])
  customerInvoice   CustomerInvoice @relation(fields: [customerInvoiceId], references: [id], onDelete: Cascade)
  department        Department?     @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  fund              Fund?           @relation(fields: [fundId], references: [id], onDelete: Restrict)
  project           Project?        @relation(fields: [projectId], references: [id], onDelete: Restrict)
  taxRate           TaxRate?        @relation(fields: [taxRateId], references: [id], onDelete: Restrict)

  @@index([customerInvoiceId])
  @@index([accountId])
  @@index([taxRateId])
  @@index([departmentId])
  @@index([projectId])
  @@index([fundId])
}

model CustomerInvoiceImportLog {
  id            String   @id @default(uuid())
  tenantId      String
  importId      String
  processedAt   DateTime @default(now())
  processedById String?
  processedBy   User?    @relation("CustomerInvoiceImportProcessedBy", fields: [processedById], references: [id], onDelete: Restrict)
  tenant        Tenant   @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, importId])
  @@index([tenantId])
  @@index([tenantId, processedAt])
  @@index([processedById])
}

model CustomerReceipt {
  id               String                @id @default(uuid())
  tenantId         String
  receiptNumber    String
  receiptDate      DateTime
  customerId       String
  currency         String
  totalAmount      Decimal               @db.Decimal(18, 2)
  paymentMethod    ReceiptPaymentMethod
  paymentReference String?
  status           ReceiptStatus         @default(DRAFT)
  createdById      String
  createdAt        DateTime              @default(now())
  postedById       String?
  postedAt         DateTime?
  voidedById       String?
  voidedAt         DateTime?
  voidReason       String?
  glJournalId      String?
  postedByUserId   String?
  exchangeRate     Decimal               @default(1.0) @db.Decimal(18, 6)
  createdBy        User                  @relation("CustomerReceiptCreatedBy", fields: [createdById], references: [id])
  customer         Customer              @relation(fields: [customerId], references: [id])
  glJournal        JournalEntry?         @relation("CustomerReceiptGlJournal", fields: [glJournalId], references: [id], onDelete: Restrict)
  postedBy         User?                 @relation("CustomerReceiptPostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  tenant           Tenant                @relation(fields: [tenantId], references: [id])
  voidedBy         User?                 @relation("CustomerReceiptVoidedBy", fields: [voidedById], references: [id], onDelete: Restrict)
  lines            CustomerReceiptLine[]
  refunds          CustomerRefund[]

  @@unique([tenantId, receiptNumber])
  @@index([tenantId])
  @@index([tenantId, status])
  @@index([customerId])
}

model CustomerReceiptLine {
  id            String          @id @default(uuid())
  receiptId     String
  invoiceId     String
  appliedAmount Decimal         @db.Decimal(18, 2)
  createdAt     DateTime        @default(now())
  tenantId      String
  invoice       CustomerInvoice @relation(fields: [invoiceId], references: [id])
  receipt       CustomerReceipt @relation(fields: [receiptId], references: [id])
  tenant        Tenant          @relation(fields: [tenantId], references: [id])

  @@unique([receiptId, invoiceId])
  @@index([receiptId])
  @@index([invoiceId])
  @@index([tenantId])
}

model Supplier {
  id          String            @id @default(uuid())
  tenantId    String
  name        String
  taxNumber   String?
  isActive    Boolean           @default(true)
  createdAt   DateTime          @default(now())
  fixedAssets FixedAsset[]
  tenant      Tenant            @relation(fields: [tenantId], references: [id])
  invoices    SupplierInvoice[]

  @@unique([tenantId, name])
  @@index([tenantId])
}

model SupplierInvoice {
  id            String                @id @default(uuid())
  tenantId      String
  supplierId    String
  invoiceNumber String
  invoiceDate   DateTime
  dueDate       DateTime
  totalAmount   Decimal               @db.Decimal(18, 2)
  status        SupplierInvoiceStatus @default(DRAFT)
  createdById   String
  approvedById  String?
  postedById    String?
  createdAt     DateTime              @default(now())
  approvedAt    DateTime?
  postedAt      DateTime?
  fixedAssets   FixedAsset[]
  approvedBy    User?                 @relation("SupplierInvoiceApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  createdBy     User                  @relation("SupplierInvoiceCreatedBy", fields: [createdById], references: [id])
  postedBy      User?                 @relation("SupplierInvoicePostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  supplier      Supplier              @relation(fields: [supplierId], references: [id])
  tenant        Tenant                @relation(fields: [tenantId], references: [id])
  lines         SupplierInvoiceLine[]

  @@unique([tenantId, supplierId, invoiceNumber])
  @@index([tenantId])
  @@index([tenantId, status])
}

model SupplierInvoiceLine {
  id                String          @id @default(uuid())
  supplierInvoiceId String
  accountId         String
  description       String
  amount            Decimal         @db.Decimal(18, 2)
  account           Account         @relation(fields: [accountId], references: [id])
  supplierInvoice   SupplierInvoice @relation(fields: [supplierInvoiceId], references: [id], onDelete: Cascade)

  @@index([supplierInvoiceId])
  @@index([accountId])
}

model Tenant {
  id                             String                          @id @default(uuid())
  name                           String                          @unique
  status                         TenantStatus                    @default(ACTIVE)
  createdAt                      DateTime                        @default(now())
  logoUrl                        String?
  organisationName               String                          @default("USPIRE ERP")
  organisationShortName          String?
  primaryColor                   String                          @default("#020445")
  secondaryColor                 String?
  updatedAt                      DateTime                        @default(now()) @updatedAt
  accentColor                    String?
  country                        String?
  dateFormat                     String?
  defaultCurrency                String?
  defaultDashboard               String?
  defaultLandingPage             String?
  defaultLanguage                String?
  defaultUserRoleCode            String?
  demoModeEnabled                Boolean?                        @default(false)
  faviconUrl                     String?
  financialYearStartMonth        Int?
  legalName                      String?
  numberFormat                   String?
  secondaryAccentColor           String?
  timezone                       String?
  coaFrozen                      Boolean                         @default(false)
  coaLockedAt                    DateTime?
  arControlAccountId             String?
  defaultBankClearingAccountId   String?
  unappliedReceiptsAccountId     String?
  allowSelfPosting               Boolean                         @default(false)
  receiptBankName                String?
  receiptBankAccountName         String?
  receiptBankAccountNumber       String?
  receiptBankBranch              String?
  receiptBankSwiftCode           String?
  requiresDepartmentOnInvoices   Boolean                         @default(false)
  requiresFundOnInvoices         Boolean                         @default(false)
  requiresProjectOnInvoices      Boolean                         @default(false)
  cashClearingAccountId          String?
  accounts                       Account[]
  periods                        AccountingPeriod[]
  accountingPeriodChecklists     AccountingPeriodChecklist[]
  accountingPeriodChecklistItems AccountingPeriodChecklistItem[]
  accountingPeriodCloseLogs      AccountingPeriodCloseLog[]
  accountingPeriodCorrections    AccountingPeriodCorrection[]
  arReminderLogs                 ArReminderLog[]
  arReminderRules                ArReminderRule[]
  arReminderTemplates            ArReminderTemplate[]
  auditEvents                    AuditEvent[]
  auditEvidence                  AuditEvidence[]
  bankAccounts                   BankAccount[]
  bankReconciliations            BankReconciliation[]
  bankStatements                 BankStatement[]
  budgets                        Budget[]
  budgetLines                    BudgetLine[]
  budgetRevisions                BudgetRevision[]
  coaCanonicalSnapshots          CoaCanonicalSnapshot[]
  customers                      Customer[]
  customerCreditNotes            CustomerCreditNote[]
  customerInvoices               CustomerInvoice[]
  customerInvoiceImportLogs      CustomerInvoiceImportLog[]
  customerReceipts               CustomerReceipt[]
  customerReceiptLines           CustomerReceiptLine[]
  refunds                        CustomerRefund[]
  departments                    Department[]
  disclosureNotes                DisclosureNote[]
  entities                       Entity[]
  fixedAssets                    FixedAsset[]
  fixedAssetCategories           FixedAssetCategory[]
  fixedAssetDepreciationLines    FixedAssetDepreciationLine[]
  fixedAssetDepreciationRuns     FixedAssetDepreciationRun[]
  forecasts                      Forecast[]
  funds                          Fund[]
  invoiceCategories              InvoiceCategory[]
  invoiceTaxLines                InvoiceTaxLine[]
  journals                       JournalEntry[]
  legalEntities                  LegalEntity[]
  payments                       Payment[]
  periodCloseChecklists          PeriodCloseChecklist[]
  periodCloseChecklistItems      PeriodCloseChecklistItem[]
  projects                       Project[]
  recurringJournalGenerations    RecurringJournalGeneration[]
  recurringJournalTemplates      RecurringJournalTemplate[]
  reviewPacks                    ReviewPack[]
  roles                          Role[]
  sodRules                       SoDRule[]
  sodLogs                        SoDViolationLog[]
  suppliers                      Supplier[]
  supplierInvoices               SupplierInvoice[]
  taxRates                       TaxRate[]
  arControlAccount               Account?                        @relation("TenantArControlAccount", fields: [arControlAccountId], references: [id], onDelete: Restrict)
  cashClearingAccount            Account?                        @relation("TenantCashClearingAccount", fields: [cashClearingAccountId], references: [id], onDelete: Restrict)
  defaultBankClearingAccount     Account?                        @relation("TenantDefaultBankClearingAccount", fields: [defaultBankClearingAccountId], references: [id], onDelete: Restrict)
  unappliedReceiptsAccount       Account?                        @relation("TenantUnappliedReceiptsAccount", fields: [unappliedReceiptsAccountId], references: [id], onDelete: Restrict)
  sequenceCounters               TenantSequenceCounter[]
  taxConfig                      TenantTaxConfig?
  users                          User[]

  @@index([status])
}

model Entity {
  id              String   @id @default(uuid())
  tenantId        String
  name            String
  jurisdiction    String
  baseCurrency    String
  fiscalYearStart Int
  createdAt       DateTime @default(now())
  tenant          Tenant   @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, name])
  @@index([tenantId])
}

model LegalEntity {
  id            String        @id @default(uuid())
  tenantId      String
  code          String
  name          String
  isActive      Boolean       @default(true)
  effectiveFrom DateTime
  effectiveTo   DateTime?
  createdById   String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @default(now()) @updatedAt
  budgetLines   BudgetLine[]
  journalLines  JournalLine[]
  createdBy     User?         @relation("LegalEntityCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  tenant        Tenant        @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, isActive])
  @@index([tenantId, effectiveFrom])
  @@index([tenantId, effectiveTo])
  @@index([createdById])
}

model Project {
  id                      String                   @id @default(uuid())
  tenantId                String
  code                    String
  name                    String
  isRestricted            Boolean                  @default(false)
  isActive                Boolean                  @default(true)
  effectiveFrom           DateTime
  effectiveTo             DateTime?
  createdById             String?
  createdAt               DateTime                 @default(now())
  updatedAt               DateTime                 @default(now()) @updatedAt
  status                  ProjectStatus            @default(ACTIVE)
  budgetLines             BudgetLine[]
  customerCreditNoteLines CustomerCreditNoteLine[]
  customerInvoices        CustomerInvoice[]        @relation("CustomerInvoiceProject")
  invoiceLines            CustomerInvoiceLine[]
  funds                   Fund[]
  journalLines            JournalLine[]
  createdBy               User?                    @relation("ProjectCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  tenant                  Tenant                   @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, status])
  @@index([tenantId, isActive])
  @@index([tenantId, isRestricted])
  @@index([tenantId, effectiveFrom])
  @@index([tenantId, effectiveTo])
  @@index([createdById])
}

model Fund {
  id                      String                   @id @default(uuid())
  tenantId                String
  projectId               String
  code                    String
  name                    String
  isActive                Boolean                  @default(true)
  effectiveFrom           DateTime
  effectiveTo             DateTime?
  createdById             String?
  createdAt               DateTime                 @default(now())
  updatedAt               DateTime                 @default(now()) @updatedAt
  status                  MasterStatus             @default(ACTIVE)
  budgetLines             BudgetLine[]
  customerCreditNoteLines CustomerCreditNoteLine[]
  customerInvoices        CustomerInvoice[]
  invoiceLines            CustomerInvoiceLine[]
  createdBy               User?                    @relation("FundCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  project                 Project                  @relation(fields: [projectId], references: [id])
  tenant                  Tenant                   @relation(fields: [tenantId], references: [id])
  journalLines            JournalLine[]

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, status])
  @@index([tenantId, projectId])
  @@index([tenantId, isActive])
  @@index([tenantId, effectiveFrom])
  @@index([tenantId, effectiveTo])
  @@index([createdById])
}

model Department {
  id                      String                   @id @default(uuid())
  tenantId                String
  code                    String
  name                    String
  isActive                Boolean                  @default(true)
  effectiveFrom           DateTime
  effectiveTo             DateTime?
  createdById             String?
  createdAt               DateTime                 @default(now())
  updatedAt               DateTime                 @default(now()) @updatedAt
  status                  MasterStatus             @default(ACTIVE)
  budgetLines             BudgetLine[]
  customerCreditNoteLines CustomerCreditNoteLine[]
  customerInvoices        CustomerInvoice[]
  invoiceLines            CustomerInvoiceLine[]
  createdBy               User?                    @relation("DepartmentCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  tenant                  Tenant                   @relation(fields: [tenantId], references: [id])
  journalLines            JournalLine[]

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, isActive])
  @@index([tenantId, effectiveFrom])
  @@index([tenantId, effectiveTo])
  @@index([createdById])
}

model User {
  id                                      String                          @id @default(uuid())
  tenantId                                String
  email                                   String
  passwordHash                            String
  isActive                                Boolean                         @default(true)
  createdAt                               DateTime                        @default(now())
  name                                    String
  accountsCreated                         Account[]                       @relation("AccountCreatedBy")
  periodsClosed                           AccountingPeriod[]              @relation("PeriodClosedBy")
  accountingPeriodsCreated                AccountingPeriod[]              @relation("AccountingPeriodCreatedBy")
  accountingPeriodChecklistsCompleted     AccountingPeriodChecklist[]     @relation("AccountingPeriodChecklistCompletedBy")
  accountingPeriodChecklistItemsCompleted AccountingPeriodChecklistItem[] @relation("AccountingPeriodChecklistItemCompletedBy")
  accountingPeriodCloseLogs               AccountingPeriodCloseLog[]
  accountingPeriodCorrections             AccountingPeriodCorrection[]
  arReminderLogsSent                      ArReminderLog[]                 @relation("ArReminderLogSentBy")
  arReminderRulesCreated                  ArReminderRule[]                @relation("ArReminderRuleCreatedBy")
  arReminderTemplatesUpdated              ArReminderTemplate[]            @relation("ArReminderTemplateLastUpdatedBy")
  auditEvents                             AuditEvent[]
  auditEvidenceUploaded                   AuditEvidence[]                 @relation("AuditEvidenceUploadedBy")
  budgetsApproved                         Budget[]                        @relation("BudgetApprovedBy")
  budgetsCreated                          Budget[]                        @relation("BudgetCreatedBy")
  budgetRevisions                         BudgetRevision[]                @relation("BudgetRevisionCreatedBy")
  coaCanonicalSnapshotsUploaded           CoaCanonicalSnapshot[]          @relation("CoaCanonicalSnapshotUploadedBy")
  customerCreditNotesApproved             CustomerCreditNote[]            @relation("CustomerCreditNoteApprovedBy")
  customerCreditNotesCreated              CustomerCreditNote[]            @relation("CustomerCreditNoteCreatedBy")
  customerCreditNotesPosted               CustomerCreditNote[]            @relation("CustomerCreditNotePostedBy")
  customerCreditNotesVoided               CustomerCreditNote[]            @relation("CustomerCreditNoteVoidedBy")
  customerInvoicesCreated                 CustomerInvoice[]               @relation("CustomerInvoiceCreatedBy")
  customerInvoicesPosted                  CustomerInvoice[]               @relation("CustomerInvoicePostedBy")
  customerInvoiceImportsProcessed         CustomerInvoiceImportLog[]      @relation("CustomerInvoiceImportProcessedBy")
  customerReceiptsCreated                 CustomerReceipt[]               @relation("CustomerReceiptCreatedBy")
  customerReceiptsPosted                  CustomerReceipt[]               @relation("CustomerReceiptPostedBy")
  customerReceiptsVoided                  CustomerReceipt[]               @relation("CustomerReceiptVoidedBy")
  customerRefundsApproved                 CustomerRefund[]                @relation("CustomerRefundApprovedBy")
  customerRefundsCreated                  CustomerRefund[]                @relation("CustomerRefundCreatedBy")
  customerRefundsPosted                   CustomerRefund[]                @relation("CustomerRefundPostedBy")
  customerRefundsVoided                   CustomerRefund[]                @relation("CustomerRefundVoidedBy")
  departmentsCreated                      Department[]                    @relation("DepartmentCreatedBy")
  disclosureNotesGenerated                DisclosureNote[]                @relation("DisclosureNoteGeneratedBy")
  fixedAssetsCreated                      FixedAsset[]                    @relation("FixedAssetCreatedBy")
  fixedAssetDepreciationRunsPosted        FixedAssetDepreciationRun[]     @relation("FixedAssetDepreciationRunPostedBy")
  forecastsCreated                        Forecast[]                      @relation("ForecastCreatedBy")
  forecastVersionsCreated                 ForecastVersion[]               @relation("ForecastVersionCreatedBy")
  fundsCreated                            Fund[]                          @relation("FundCreatedBy")
  journalsApproved                        JournalEntry[]                  @relation("JournalApprovedBy")
  journalsCreated                         JournalEntry[]                  @relation("JournalCreatedBy")
  journalsPosted                          JournalEntry[]                  @relation("JournalPostedBy")
  journalsRejected                        JournalEntry[]                  @relation("JournalRejectedBy")
  journalsReturnedByPoster                JournalEntry[]                  @relation("JournalReturnedByPoster")
  journalsReversalInitiated               JournalEntry[]                  @relation("JournalReversalInitiatedBy")
  journalsReversalPrepared                JournalEntry[]                  @relation("JournalReversalPreparedBy")
  journalsReviewed                        JournalEntry[]                  @relation("JournalReviewedBy")
  journalsSubmitted                       JournalEntry[]                  @relation("JournalSubmittedBy")
  legalEntitiesCreated                    LegalEntity[]                   @relation("LegalEntityCreatedBy")
  paymentsApproved                        Payment[]                       @relation("PaymentApprovedBy")
  paymentsCreated                         Payment[]                       @relation("PaymentCreatedBy")
  paymentsPosted                          Payment[]                       @relation("PaymentPostedBy")
  periodCloseChecklistItemsCompleted      PeriodCloseChecklistItem[]      @relation("PeriodCloseChecklistItemCompletedBy")
  projectsCreated                         Project[]                       @relation("ProjectCreatedBy")
  recurringJournalGenerations             RecurringJournalGeneration[]    @relation("RecurringJournalGeneratedBy")
  recurringJournalTemplatesCreated        RecurringJournalTemplate[]      @relation("RecurringTemplateCreatedBy")
  reviewPacksGenerated                    ReviewPack[]                    @relation("ReviewPackGeneratedBy")
  sodLogs                                 SoDViolationLog[]
  supplierInvoicesApproved                SupplierInvoice[]               @relation("SupplierInvoiceApprovedBy")
  supplierInvoicesCreated                 SupplierInvoice[]               @relation("SupplierInvoiceCreatedBy")
  supplierInvoicesPosted                  SupplierInvoice[]               @relation("SupplierInvoicePostedBy")
  tenant                                  Tenant                          @relation(fields: [tenantId], references: [id])
  userRoles                               UserRole[]

  @@unique([tenantId, email])
  @@index([tenantId])
}

model Role {
  id              String           @id @default(uuid())
  tenantId        String
  name            String
  description     String?
  createdAt       DateTime         @default(now())
  tenant          Tenant           @relation(fields: [tenantId], references: [id])
  rolePermissions RolePermission[]
  userRoles       UserRole[]

  @@unique([tenantId, name])
  @@index([tenantId])
}

model Permission {
  id              String           @id @default(uuid())
  code            String           @unique
  description     String?
  rolePermissions RolePermission[]
}

model RolePermission {
  roleId       String
  permissionId String
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)
  role         Role       @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@id([roleId, permissionId])
  @@index([permissionId])
}

model UserRole {
  userId String
  roleId String
  role   Role   @relation(fields: [roleId], references: [id], onDelete: Cascade)
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([userId, roleId])
  @@index([roleId])
}

model SoDRule {
  id                   String   @id @default(uuid())
  tenantId             String
  forbiddenPermissionA String
  forbiddenPermissionB String
  description          String?
  createdAt            DateTime @default(now())
  tenant               Tenant   @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, forbiddenPermissionA, forbiddenPermissionB])
  @@index([tenantId])
}

model SoDViolationLog {
  id                    String   @id @default(uuid())
  tenantId              String
  userId                String
  permissionAttempted   String
  conflictingPermission String
  timestamp             DateTime @default(now())
  tenant                Tenant   @relation(fields: [tenantId], references: [id])
  user                  User     @relation(fields: [userId], references: [id])

  @@index([tenantId])
  @@index([userId])
}

model Account {
  id                                      String                         @id @default(uuid())
  tenantId                                String
  code                                    String
  name                                    String
  type                                    AccountType
  isActive                                Boolean                        @default(true)
  createdAt                               DateTime                       @default(now())
  isCashEquivalent                        Boolean                        @default(false)
  createdById                             String?
  ifrsMappingCode                         String?
  isFrozen                                Boolean                        @default(false)
  isPosting                               Boolean                        @default(true)
  parentAccountId                         String?
  updatedAt                               DateTime                       @default(now()) @updatedAt
  hierarchyPath                           String?
  isControlAccount                        Boolean                        @default(false)
  isPostingAllowed                        Boolean                        @default(true)
  normalBalance                           NormalBalance                  @default(DEBIT)
  requiresFund                            Boolean                        @default(false)
  requiresProject                         Boolean                        @default(false)
  budgetControlMode                       BudgetControlMode              @default(WARN)
  isBudgetRelevant                        Boolean                        @default(false)
  fsMappingLevel1                         String?
  fsMappingLevel2                         String?
  subCategory                             String?
  requiresDepartment                      Boolean                        @default(false)
  createdBy                               User?                          @relation("AccountCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  parentAccount                           Account?                       @relation("AccountHierarchy", fields: [parentAccountId], references: [id], onDelete: Restrict)
  childAccounts                           Account[]                      @relation("AccountHierarchy")
  tenant                                  Tenant                         @relation(fields: [tenantId], references: [id])
  bankAccounts                            BankAccount[]
  budgetLines                             BudgetLine[]
  customerCreditNoteLinesAsRevenueAccount CustomerCreditNoteLine[]
  customerInvoiceLines                    CustomerInvoiceLine[]
  fixedAssetsAsAccumDepAccount            FixedAsset[]                   @relation("FixedAssetAccumDepAccount")
  fixedAssetsAsAssetAccount               FixedAsset[]                   @relation("FixedAssetAssetAccount")
  fixedAssetsAsDepExpenseAccount          FixedAsset[]                   @relation("FixedAssetDepExpenseAccount")
  fixedAssetCategoriesAsAccumDepAccount   FixedAssetCategory[]           @relation("FixedAssetCategoryAccumDepAccount")
  fixedAssetCategoriesAsAssetAccount      FixedAssetCategory[]           @relation("FixedAssetCategoryAssetAccount")
  fixedAssetCategoriesAsDepExpenseAccount FixedAssetCategory[]           @relation("FixedAssetCategoryDepExpenseAccount")
  forecastLines                           ForecastLine[]
  invoiceCategoriesAsRevenueAccount       InvoiceCategory[]              @relation("InvoiceCategoryRevenueAccount")
  lines                                   JournalLine[]
  recurringTemplateLines                  RecurringJournalTemplateLine[]
  supplierInvoiceLines                    SupplierInvoiceLine[]
  taxRates                                TaxRate[]
  tenantsAsArControlAccount               Tenant[]                       @relation("TenantArControlAccount")
  tenantsAsCashClearingAccount            Tenant[]                       @relation("TenantCashClearingAccount")
  tenantsAsDefaultBankClearingAccount     Tenant[]                       @relation("TenantDefaultBankClearingAccount")
  tenantsAsUnappliedReceiptsAccount       Tenant[]                       @relation("TenantUnappliedReceiptsAccount")
  tenantTaxConfigsAsInputVatAccount       TenantTaxConfig[]              @relation("TenantTaxConfigInputVatAccount")
  tenantTaxConfigsAsOutputVatAccount      TenantTaxConfig[]              @relation("TenantTaxConfigOutputVatAccount")

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, parentAccountId])
  @@index([createdById])
}

model CoaCanonicalSnapshot {
  id           String   @id @default(uuid())
  tenantId     String
  uploadedAt   DateTime @default(now())
  uploadedById String?
  fileName     String?
  format       String?
  rowCount     Int      @default(0)
  hash         String?
  data         Json
  tenant       Tenant   @relation(fields: [tenantId], references: [id])
  uploadedBy   User?    @relation("CoaCanonicalSnapshotUploadedBy", fields: [uploadedById], references: [id], onDelete: Restrict)

  @@index([tenantId])
  @@index([uploadedAt])
}

model JournalEntry {
  id                          String                       @id @default(uuid())
  tenantId                    String
  reference                   String?
  description                 String?
  status                      JournalStatus                @default(DRAFT)
  createdById                 String
  postedById                  String?
  createdAt                   DateTime                     @default(now())
  postedAt                    DateTime?
  journalDate                 DateTime                     @default(now())
  approvedById                String?
  journalNumber               Int?
  journalType                 JournalType                  @default(STANDARD)
  periodId                    String?
  reversalOfId                String?
  reviewedById                String?
  approvedAt                  DateTime?
  reviewedAt                  DateTime?
  submittedAt                 DateTime?
  submittedById               String?
  rejectedAt                  DateTime?
  rejectedById                String?
  rejectionReason             String?
  returnReason                String?
  returnedByPosterAt          DateTime?
  returnedByPosterId          String?
  reversalInitiatedAt         DateTime?
  reversalInitiatedById       String?
  reversalReason              String?
  reversalPreparedById        String?
  correctsJournalId           String?
  riskScore                   Int                          @default(0)
  riskFlags                   Json                         @default("[]")
  riskComputedAt              DateTime?
  budgetCheckedAt             DateTime?
  budgetFlags                 Json?
  budgetOverrideJustification String?
  budgetStatus                JournalBudgetStatus          @default(OK)
  sourceType                  String?
  sourceId                    String?
  customerCreditNotesPosted   CustomerCreditNote[]         @relation("CustomerCreditNotePostedJournal")
  customerReceiptsGl          CustomerReceipt[]            @relation("CustomerReceiptGlJournal")
  customerRefundsPosted       CustomerRefund[]             @relation("CustomerRefundPostedJournal")
  fixedAssetCapitalizations   FixedAsset[]                 @relation("FixedAssetCapitalizationJournal")
  fixedAssetDisposals         FixedAsset[]                 @relation("FixedAssetDisposalJournal")
  fixedAssetDepreciationRuns  FixedAssetDepreciationRun[]  @relation("FixedAssetDepreciationRunJournal")
  approvedBy                  User?                        @relation("JournalApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  correctsJournal             JournalEntry?                @relation("JournalCorrection", fields: [correctsJournalId], references: [id], onDelete: Restrict)
  correctedBy                 JournalEntry[]               @relation("JournalCorrection")
  createdBy                   User                         @relation("JournalCreatedBy", fields: [createdById], references: [id])
  period                      AccountingPeriod?            @relation(fields: [periodId], references: [id], onDelete: Restrict)
  postedBy                    User?                        @relation("JournalPostedBy", fields: [postedById], references: [id], onDelete: Restrict)
  rejectedBy                  User?                        @relation("JournalRejectedBy", fields: [rejectedById], references: [id], onDelete: Restrict)
  returnedByPoster            User?                        @relation("JournalReturnedByPoster", fields: [returnedByPosterId], references: [id], onDelete: Restrict)
  reversalInitiatedBy         User?                        @relation("JournalReversalInitiatedBy", fields: [reversalInitiatedById], references: [id], onDelete: Restrict)
  reversalOf                  JournalEntry?                @relation("JournalReversal", fields: [reversalOfId], references: [id], onDelete: Restrict)
  reversedBy                  JournalEntry[]               @relation("JournalReversal")
  reversalPreparedBy          User?                        @relation("JournalReversalPreparedBy", fields: [reversalPreparedById], references: [id], onDelete: Restrict)
  reviewedBy                  User?                        @relation("JournalReviewedBy", fields: [reviewedById], references: [id], onDelete: Restrict)
  submittedBy                 User?                        @relation("JournalSubmittedBy", fields: [submittedById], references: [id], onDelete: Restrict)
  tenant                      Tenant                       @relation(fields: [tenantId], references: [id])
  lines                       JournalLine[]
  recurringGenerations        RecurringJournalGeneration[] @relation("RecurringGeneratedJournal")

  @@unique([tenantId, journalNumber])
  @@index([tenantId])
  @@index([tenantId, journalType])
  @@index([tenantId, periodId])
  @@index([tenantId, status])
  @@index([tenantId, status, journalDate])
  @@index([tenantId, sourceType, sourceId])
}

model RecurringJournalTemplate {
  id                  String                         @id @default(uuid())
  tenantId            String
  name                String
  journalType         JournalType                    @default(STANDARD)
  referenceTemplate   String
  descriptionTemplate String?
  frequency           RecurringJournalFrequency
  startDate           DateTime
  endDate             DateTime?
  nextRunDate         DateTime
  isActive            Boolean                        @default(true)
  createdById         String
  createdAt           DateTime                       @default(now())
  history             RecurringJournalGeneration[]
  createdBy           User                           @relation("RecurringTemplateCreatedBy", fields: [createdById], references: [id])
  tenant              Tenant                         @relation(fields: [tenantId], references: [id])
  lines               RecurringJournalTemplateLine[]

  @@unique([tenantId, name])
  @@index([tenantId])
  @@index([tenantId, isActive])
  @@index([tenantId, nextRunDate])
  @@index([createdById])
}

model RecurringJournalTemplateLine {
  id                  String                   @id @default(uuid())
  templateId          String
  accountId           String
  descriptionTemplate String?
  debitAmount         Decimal                  @db.Decimal(18, 2)
  creditAmount        Decimal                  @db.Decimal(18, 2)
  lineOrder           Int
  account             Account                  @relation(fields: [accountId], references: [id])
  template            RecurringJournalTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@unique([templateId, lineOrder])
  @@index([templateId])
  @@index([accountId])
}

model RecurringJournalGeneration {
  id                 String                   @id @default(uuid())
  tenantId           String
  templateId         String
  generatedJournalId String
  runDate            DateTime
  generatedById      String
  createdAt          DateTime                 @default(now())
  generatedBy        User                     @relation("RecurringJournalGeneratedBy", fields: [generatedById], references: [id])
  generatedJournal   JournalEntry             @relation("RecurringGeneratedJournal", fields: [generatedJournalId], references: [id])
  template           RecurringJournalTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)
  tenant             Tenant                   @relation(fields: [tenantId], references: [id])

  @@unique([tenantId, templateId, runDate])
  @@index([tenantId])
  @@index([tenantId, templateId])
  @@index([generatedJournalId])
  @@index([generatedById])
}

model AccountingPeriod {
  id                         String                          @id @default(uuid())
  tenantId                   String
  name                       String
  startDate                  DateTime
  endDate                    DateTime
  status                     AccountingPeriodStatus          @default(OPEN)
  closedById                 String?
  closedAt                   DateTime?
  createdAt                  DateTime                        @default(now())
  code                       String?
  createdById                String?
  type                       AccountingPeriodType            @default(NORMAL)
  updatedAt                  DateTime                        @default(now()) @updatedAt
  closedBy                   User?                           @relation("PeriodClosedBy", fields: [closedById], references: [id], onDelete: Restrict)
  createdBy                  User?                           @relation("AccountingPeriodCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  tenant                     Tenant                          @relation(fields: [tenantId], references: [id])
  checklists                 AccountingPeriodChecklist[]
  checklistItems             AccountingPeriodChecklistItem[]
  closeLogs                  AccountingPeriodCloseLog[]
  corrections                AccountingPeriodCorrection[]
  budgetLines                BudgetLine[]
  disclosureNotes            DisclosureNote[]                @relation("DisclosureNotePeriod")
  fixedAssetDepreciationRuns FixedAssetDepreciationRun[]
  journals                   JournalEntry[]
  periodCloseChecklist       PeriodCloseChecklist?
  reviewPacks                ReviewPack[]

  @@unique([tenantId, code])
  @@index([tenantId])
  @@index([tenantId, type])
  @@index([tenantId, status])
  @@index([tenantId, startDate, endDate])
  @@index([createdById])
}

model AccountingPeriodCorrection {
  id           String           @id @default(uuid())
  tenantId     String
  periodId     String
  oldStartDate DateTime
  oldEndDate   DateTime
  newStartDate DateTime
  newEndDate   DateTime
  reason       String
  correctedBy  String
  correctedAt  DateTime         @default(now())
  user         User             @relation(fields: [correctedBy], references: [id])
  period       AccountingPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)
  tenant       Tenant           @relation(fields: [tenantId], references: [id])

  @@index([tenantId])
  @@index([tenantId, periodId])
  @@index([correctedBy])
}

model DisclosureNote {
  id                 String               @id @default(uuid())
  tenantId           String
  accountingPeriodId String
  noteType           DisclosureNoteType
  generatedAt        DateTime
  generatedById      String
  metadata           Json?
  createdAt          DateTime             @default(now())
  accountingPeriod   AccountingPeriod     @relation("DisclosureNotePeriod", fields: [accountingPeriodId], references: [id])
  generatedBy        User                 @relation("DisclosureNoteGeneratedBy", fields: [generatedById], references: [id])
  tenant             Tenant               @relation(fields: [tenantId], references: [id])
  lines              DisclosureNoteLine[]

  @@unique([tenantId, accountingPeriodId, noteType])
  @@index([tenantId])
  @@index([tenantId, accountingPeriodId])
  @@index([tenantId, noteType])
}

model DisclosureNoteLine {
  id               String         @id @default(uuid())
  disclosureNoteId String
  rowKey           String
  label            String
  values           Json
  orderIndex       Int
  disclosureNote   DisclosureNote @relation(fields: [disclosureNoteId], references: [id], onDelete: Cascade)

  @@unique([disclosureNoteId, rowKey])
  @@unique([disclosureNoteId, orderIndex])
  @@index([disclosureNoteId])
}

model PeriodCloseChecklist {
  id        String                     @id @default(uuid())
  tenantId  String
  periodId  String                     @unique
  createdAt DateTime                   @default(now())
  period    AccountingPeriod           @relation(fields: [periodId], references: [id])
  tenant    Tenant                     @relation(fields: [tenantId], references: [id])
  items     PeriodCloseChecklistItem[]

  @@unique([tenantId, periodId])
  @@index([tenantId])
  @@index([periodId])
}

model PeriodCloseChecklistItem {
  id            String                         @id @default(uuid())
  tenantId      String
  checklistId   String
  code          String
  name          String
  status        PeriodCloseChecklistItemStatus @default(PENDING)
  completedById String?
  completedAt   DateTime?
  createdAt     DateTime                       @default(now())
  checklist     PeriodCloseChecklist           @relation(fields: [checklistId], references: [id], onDelete: Cascade)
  completedBy   User?                          @relation("PeriodCloseChecklistItemCompletedBy", fields: [completedById], references: [id], onDelete: Restrict)
  tenant        Tenant                         @relation(fields: [tenantId], references: [id])

  @@unique([checklistId, code])
  @@index([tenantId])
  @@index([checklistId])
  @@index([completedById])
}

model JournalLine {
  id             String       @id @default(uuid())
  journalEntryId String
  accountId      String
  debit          Decimal      @default(0) @db.Decimal(18, 2)
  credit         Decimal      @default(0) @db.Decimal(18, 2)
  description    String?
  lineNumber     Int?
  departmentId   String?
  legalEntityId  String?
  fundId         String?
  projectId      String?
  account        Account      @relation(fields: [accountId], references: [id])
  department     Department?  @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  fund           Fund?        @relation(fields: [fundId], references: [id], onDelete: Restrict)
  journalEntry   JournalEntry @relation(fields: [journalEntryId], references: [id], onDelete: Cascade)
  legalEntity    LegalEntity? @relation(fields: [legalEntityId], references: [id], onDelete: Restrict)
  project        Project?     @relation(fields: [projectId], references: [id], onDelete: Restrict)

  @@index([journalEntryId])
  @@index([accountId])
  @@index([legalEntityId])
  @@index([departmentId])
  @@index([projectId])
  @@index([fundId])
  @@index([journalEntryId, lineNumber])
}

model Budget {
  id           String           @id @default(uuid())
  tenantId     String
  fiscalYear   Int
  status       BudgetStatus     @default(DRAFT)
  createdById  String
  approvedById String?
  createdAt    DateTime         @default(now())
  approvedAt   DateTime?
  approvedBy   User?            @relation("BudgetApprovedBy", fields: [approvedById], references: [id], onDelete: Restrict)
  createdBy    User             @relation("BudgetCreatedBy", fields: [createdById], references: [id])
  tenant       Tenant           @relation(fields: [tenantId], references: [id])
  lines        BudgetLine[]
  revisions    BudgetRevision[]

  @@index([tenantId])
  @@index([tenantId, fiscalYear])
}

model BudgetRevision {
  id          String       @id @default(uuid())
  tenantId    String
  budgetId    String
  revisionNo  Int
  createdAt   DateTime     @default(now())
  createdById String
  lines       BudgetLine[]
  budget      Budget       @relation(fields: [budgetId], references: [id])
  createdBy   User         @relation("BudgetRevisionCreatedBy", fields: [createdById], references: [id])
  tenant      Tenant       @relation(fields: [tenantId], references: [id])

  @@unique([budgetId, revisionNo])
  @@index([tenantId])
  @@index([tenantId, budgetId])
}

model BudgetLine {
  id            String           @id @default(uuid())
  tenantId      String
  budgetId      String
  revisionId    String
  accountId     String
  periodId      String
  amount        Decimal          @db.Decimal(18, 2)
  createdAt     DateTime         @default(now())
  departmentId  String?
  fundId        String?
  legalEntityId String?
  projectId     String?
  account       Account          @relation(fields: [accountId], references: [id])
  budget        Budget           @relation(fields: [budgetId], references: [id], onDelete: Cascade)
  department    Department?      @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  fund          Fund?            @relation(fields: [fundId], references: [id], onDelete: Restrict)
  legalEntity   LegalEntity?     @relation(fields: [legalEntityId], references: [id], onDelete: Restrict)
  period        AccountingPeriod @relation(fields: [periodId], references: [id])
  project       Project?         @relation(fields: [projectId], references: [id], onDelete: Restrict)
  revision      BudgetRevision   @relation(fields: [revisionId], references: [id], onDelete: Cascade)
  tenant        Tenant           @relation(fields: [tenantId], references: [id])

  @@unique([revisionId, accountId, periodId, legalEntityId, departmentId, projectId, fundId])
  @@index([tenantId])
  @@index([tenantId, budgetId])
  @@index([accountId])
  @@index([periodId])
  @@index([budgetId, accountId])
  @@index([legalEntityId])
  @@index([departmentId])
  @@index([projectId])
  @@index([fundId])
}

enum SupplierInvoiceStatus {
  DRAFT
  SUBMITTED
  APPROVED
  POSTED
}

enum CustomerInvoiceStatus {
  DRAFT
  POSTED
}

enum DocumentStatus {
  DRAFT
  SUBMITTED
  APPROVED
  POSTED
  VOID
}

enum InvoiceType {
  TRAINING
  CONSULTING
  SYSTEMS
  PUBLISHING
  DONATION
  OTHER
}

enum CustomerStatus {
  ACTIVE
  INACTIVE
}

enum ReceiptStatus {
  DRAFT
  POSTED
  VOIDED
}

enum ReceiptPaymentMethod {
  CASH
  CARD
  EFT
  CHEQUE
  OTHER
}

enum ArReminderTriggerType {
  BEFORE_DUE
  ON_DUE
  AFTER_DUE
}

enum ArReminderLevel {
  NORMAL
  ESCALATED
  FINAL
}

enum ArReminderTriggerMode {
  AUTO
  MANUAL
}

enum RefundPaymentMethod {
  BANK
  CASH
}

enum PaymentType {
  SUPPLIER_PAYMENT
  CUSTOMER_RECEIPT
}

enum PaymentStatus {
  DRAFT
  APPROVED
  POSTED
}

enum PaymentAllocationSourceType {
  SUPPLIER_INVOICE
  CUSTOMER_INVOICE
}

enum TaxRateType {
  OUTPUT
  INPUT
}

enum InvoiceTaxSourceType {
  SUPPLIER_INVOICE
  CUSTOMER_INVOICE
}

enum ForecastStatus {
  DRAFT
  SUBMITTED
  APPROVED
  SUPERSEDED
}

enum TenantStatus {
  ACTIVE
  INACTIVE
}

enum AccountType {
  ASSET
  LIABILITY
  EQUITY
  INCOME
  EXPENSE
}

enum DepreciationMethod {
  STRAIGHT_LINE
}

enum FixedAssetStatus {
  DRAFT
  CAPITALIZED
  DISPOSED
}

enum FixedAssetDepreciationRunStatus {
  POSTED
}

enum JournalStatus {
  DRAFT
  POSTED
  PARKED
  SUBMITTED
  REVIEWED
  REJECTED
}

enum JournalType {
  STANDARD
  ADJUSTING
  ACCRUAL
  REVERSING
}

enum RecurringJournalFrequency {
  MONTHLY
  QUARTERLY
  YEARLY
}

enum NormalBalance {
  DEBIT
  CREDIT
}

enum AccountingPeriodStatus {
  OPEN
  CLOSED
  SOFT_CLOSED
}

enum AccountingPeriodType {
  OPENING
  NORMAL
}

enum PeriodCloseChecklistItemStatus {
  PENDING
  COMPLETED
}

enum AuditOutcome {
  SUCCESS
  BLOCKED
  FAILED
}

enum MasterStatus {
  ACTIVE
  INACTIVE
}

enum ProjectStatus {
  ACTIVE
  CLOSED
}

enum AuditEventType {
  JOURNAL_POST
  PERIOD_CHECKLIST_COMPLETE
  PERIOD_CLOSE
  SOD_VIOLATION
  AP_POST
  AR_POST
  INVOICE_DRAFT_CREATED
  INVOICE_DRAFT_EDITED
  FA_CAPITALIZE
  FA_DEPRECIATION_RUN
  FA_DISPOSE
  BANK_RECONCILIATION_MATCH
  EVIDENCE_UPLOAD
  BUDGET_CREATE
  BUDGET_APPROVE
  REPORT_VIEW
  REPORT_EXPORT
  FORECAST_CREATE
  FORECAST_UPDATE
  FORECAST_SUBMIT
  FORECAST_APPROVE
  FORECAST_SUPERSEDE
  FORECAST_VIEW
  DASHBOARD_VIEW
  ORGANISATION_UPDATE
  ORGANISATION_LOGO_UPLOAD
  USER_CREATE
  USER_STATUS_CHANGE
  USER_ROLE_ASSIGN
  COA_CREATE
  COA_UPDATE
  COA_DEACTIVATE
  COA_FREEZE
  COA_UNFREEZE
  COA_HIERARCHY_CHANGE
  COA_LOCKED
  COA_UNLOCKED
  JOURNAL_CREATE
  JOURNAL_UPDATE
  JOURNAL_PARK
  JOURNAL_REVERSE
  RECURRING_TEMPLATE_CREATE
  RECURRING_TEMPLATE_UPDATE
  RECURRING_JOURNAL_GENERATED
  JOURNAL_UPLOAD
  JOURNAL_UPLOAD_FAILED
  PERIOD_REOPEN
  DISCLOSURE_NOTE_GENERATE
  DISCLOSURE_NOTE_VIEW
  GL_JOURNAL_SUBMITTED
  GL_JOURNAL_REVIEWED
  GL_JOURNAL_POSTED
  GL_JOURNAL_REVERSED
  GL_JOURNAL_POST_BLOCKED
  FA_POST
  GL_JOURNAL_REJECTED
  GL_JOURNAL_RETURNED_BY_POSTER
  GL_JOURNAL_REVERSAL_INITIATED
  GL_JOURNAL_REVERSAL_APPROVED
  GL_JOURNAL_REVERSAL_POSTED
  GL_JOURNAL_REVERSAL_ASSIGNED
  GL_JOURNAL_RISK_COMPUTED
  GL_JOURNAL_BUDGET_EVALUATED
  COA_IMPORTED
  COA_CLEANUP_EXECUTED
  PERIOD_CREATED
  PERIOD_REOPENED
  PERIOD_CLOSED
  DEPARTMENT_CREATED
  DEPARTMENT_UPDATED
  PROJECT_CREATED
  PROJECT_UPDATED
  PROJECT_CLOSED
  FUND_CREATED
  FUND_UPDATED
  INVOICE_CATEGORY_CREATED
  INVOICE_CATEGORY_UPDATED
  INVOICE_CATEGORY_STATUS_CHANGE
  TAX_RATE_CREATED
  TAX_RATE_UPDATED
  TAX_RATE_STATUS_CHANGE
  TAX_CONFIG_UPDATED
  PERIOD_CORRECTION
  PERIOD_CORRECTED
  AR_REMINDER_SENT
  AR_REMINDER_CONFIG_CHANGED
}

enum BudgetStatus {
  DRAFT
  ACTIVE
}

enum BudgetControlMode {
  WARN
  BLOCK
}

enum JournalBudgetStatus {
  OK
  WARN
  BLOCK
}

enum AuditEntityType {
  JOURNAL_ENTRY
  ACCOUNTING_PERIOD
  ACCOUNTING_PERIOD_CHECKLIST_ITEM
  SUPPLIER_INVOICE
  CUSTOMER_INVOICE
  FIXED_ASSET
  FIXED_ASSET_DEPRECIATION_RUN
  BANK_RECONCILIATION_MATCH
  USER
  BUDGET
  REPORT
  FORECAST
  TENANT
  ACCOUNT
  RECURRING_JOURNAL_TEMPLATE
  DISCLOSURE_NOTE
  CHART_OF_ACCOUNTS
  CUSTOMER_RECEIPT
  INVOICE_CATEGORY
  TAX_RATE
  TENANT_TAX_CONFIG
  DEPARTMENT
  PROJECT
  FUND
}

enum DisclosureNoteType {
  PPE_MOVEMENT
  DEPRECIATION
  TAX_RECONCILIATION
  PROVISIONS
  CONTINGENCIES
}
